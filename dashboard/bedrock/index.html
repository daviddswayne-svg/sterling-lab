<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bedrock Insurance | Swayne Systems</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/style.css?v=chat">
</head>

<body>
    <!-- Animated gradient background -->
    <div class="gradient-bg"></div>

    <!-- Main container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo-section">
                <div class="logo-text">
                    <h1>Bedrock Insurance</h1>
                    <p class="subtitle">Autonomous Publishing Division</p>
                </div>
            </div>
            <div class="status-indicator">
                <span class="status-dot"></span>
                <span class="status-text">Agents Online</span>
            </div>
        </header>

        <!-- Main content -->
        <main class="main-content">
            <section class="hero-card card-glow">
                <img src="/assets/bedrock_latest.png" class="hero-image" alt="Safe Haven">
                <div class="card-content">
                    <h2 class="hero-title">Safe Haven</h2>
                    <p class="hero-description">Discover advanced home protection strategies designed to safeguard your
                        affluent lifestyle, blending traditional security with modern smart home technology, strategic
                        landscaping, and optimized insurance coverage.</p>
                </div>
            </section>

            <section class="info-grid">
                <article class="info-card">
                    <h3>Smart Home Integration</h3>
                    <p>Leverage the latest in smart home technology to enhance your traditional security systems,
                        providing unparalleled protection and convenience.</p>
                </article>
                <article class="info-card">
                    <h3>Natural Disaster Mitigation</h3>
                    <p>Proactively manage natural disaster risks through expert landscaping and construction techniques
                        tailored for high-value properties.</p>
                </article>
                <article class="info-card">
                    <h3>Insurance Optimization</h3>
                    <p>Ensure your high-value assets and luxury items are fully protected with strategically optimized
                        insurance coverage tailored to your needs.</p>
                </article>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>© 2025 Bedrock Insurance (A Swayne Systems Entity)</p>
            <p style="margin-top: 0.5rem; font-size: 0.75rem;"><a href="/"
                    style="color: rgba(255,255,255,0.3); text-decoration: none;">Internal Dashboard</a></p>
        </footer>
    </div>
    <!-- Chat Widget -->
    <div class="chat-widget">
        <div class="chat-window" id="chatWindow">
            <div class="chat-header">
                <h3>Bedrock Assistant</h3>
                <button class="close-chat" onclick="toggleChat()">×</button>
            </div>
            <div class="chat-messages" id="chatMessages">
                <div class="message bot">
                    Hello! I'm your Bedrock Insurance specialist. How can I protect your estate today?
                </div>
            </div>
            <div class="chat-input-area">
                <input type="text" id="chatInput" placeholder="Ask about safety..." onkeypress="handleKeyPress(event)">
                <button class="chat-send" onclick="sendMessage()">➤</button>
            </div>
        </div>
        <button class="chat-toggle" onclick="toggleChat()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
            </svg>
        </button>
    </div>

    <script>
        function toggleChat() {
            document.getElementById('chatWindow').classList.toggle('active');
            if (document.getElementById('chatWindow').classList.contains('active')) {
                document.getElementById('chatInput').focus();
            }
        }

        function handleKeyPress(e) {
            if (e.key === 'Enter') sendMessage();
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const messages = document.getElementById('chatMessages');
            const userText = input.value.trim();

            if (!userText) return;

            // Add User Message
            addMessage(userText, 'user');
            input.value = '';

            // Show Thinking
            const thinkingId = addMessage('Analyzing...', 'bot thinking');

            try {
                // Call API
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: userText })
                });

                const data = await response.json();

                // Remove Thinking
                document.getElementById(thinkingId).remove();

                if (data.error) {
                    addMessage("Error: " + data.error, 'bot');
                } else {
                    addMessage(data.reply, 'bot');
                }
            } catch (e) {
                document.getElementById(thinkingId).remove();
                addMessage("Connection error. Is the AI awake?", 'bot');
            }
        }

        function addMessage(text, type) {
            const messages = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = `message ${type.split(' ')[0]}`;
            div.textContent = text;
            div.id = 'msg-' + Date.now();
            messages.appendChild(div);
            messages.scrollTop = messages.scrollHeight;
            return div.id;
        }
    </script>
</body>

</html>